"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/login/route";
exports.ids = ["app/api/auth/login/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Windows_11_gemini_antigravity_scratch_presentbox_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/login/route.ts */ \"(rsc)/./app/api/auth/login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/login/route\",\n        pathname: \"/api/auth/login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/login/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Windows 11\\\\.gemini\\\\antigravity\\\\scratch\\\\presentbox\\\\app\\\\api\\\\auth\\\\login\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Windows_11_gemini_antigravity_scratch_presentbox_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNXaW5kb3dzJTIwMTElNUMuZ2VtaW5pJTVDYW50aWdyYXZpdHklNUNzY3JhdGNoJTVDcHJlc2VudGJveCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDV2luZG93cyUyMDExJTVDLmdlbWluaSU1Q2FudGlncmF2aXR5JTVDc2NyYXRjaCU1Q3ByZXNlbnRib3gmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2lEO0FBQzlIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJlc2VudGJveC8/ZWVlNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxXaW5kb3dzIDExXFxcXC5nZW1pbmlcXFxcYW50aWdyYXZpdHlcXFxcc2NyYXRjaFxcXFxwcmVzZW50Ym94XFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxsb2dpblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvbG9naW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvbG9naW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxXaW5kb3dzIDExXFxcXC5nZW1pbmlcXFxcYW50aWdyYXZpdHlcXFxcc2NyYXRjaFxcXFxwcmVzZW50Ym94XFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxsb2dpblxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/login/route.ts":
/*!*************************************!*\
  !*** ./app/api/auth/login/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_admins__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/admins */ \"(rsc)/./lib/admins.ts\");\n/* harmony import */ var _lib_security__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/security */ \"(rsc)/./lib/security.ts\");\n\n\n\nasync function POST(request) {\n    try {\n        const { username, password } = await request.json();\n        if (!username || !password) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Login va parol kiritilishi shart\"\n            }, {\n                status: 400\n            });\n        }\n        const admins = (0,_lib_admins__WEBPACK_IMPORTED_MODULE_1__.getAdmins)();\n        const admin = admins.find((a)=>a.username === username);\n        if (!admin) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Login yoki parol noto'g'ri\"\n            }, {\n                status: 401\n            });\n        }\n        // Check if admin has hash/salt (new system)\n        if (admin.hash && admin.salt) {\n            const isValid = await (0,_lib_security__WEBPACK_IMPORTED_MODULE_2__.verifyPassword)(password, admin.hash, admin.salt);\n            if (!isValid) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Login yoki parol noto'g'ri\"\n                }, {\n                    status: 401\n                });\n            }\n        } else if (admin.password) {\n            // Fallback for old system (if any entries left)\n            if (admin.password !== password) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Login yoki parol noto'g'ri\"\n                }, {\n                    status: 401\n                });\n            }\n        } else {\n            // No credentials found\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Login yoki parol noto'g'ri\"\n            }, {\n                status: 401\n            });\n        }\n        // Success - Create Session\n        const expiresAt = Date.now() + 24 * 60 * 60 * 1000; // 1 day\n        const payload = `${admin.username}|${admin.roleId}|${expiresAt}`;\n        const token = await (0,_lib_security__WEBPACK_IMPORTED_MODULE_2__.signSession)(payload);\n        const { hash, salt, password: _, ...adminSafe } = admin;\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            user: adminSafe\n        });\n        response.cookies.set(\"admin_session\", token, {\n            httpOnly: true,\n            secure: \"development\" === \"production\",\n            sameSite: \"strict\",\n            maxAge: 60 * 60 * 24,\n            path: \"/\"\n        });\n        return response;\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Tizim xatoligi\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQztBQUNGO0FBQ29CO0FBRXRELGVBQWVJLEtBQUtDLE9BQWdCO0lBQ3ZDLElBQUk7UUFDQSxNQUFNLEVBQUVDLFFBQVEsRUFBRUMsUUFBUSxFQUFFLEdBQUcsTUFBTUYsUUFBUUcsSUFBSTtRQUVqRCxJQUFJLENBQUNGLFlBQVksQ0FBQ0MsVUFBVTtZQUN4QixPQUFPUCxxREFBWUEsQ0FBQ1EsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQW1DLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMxRjtRQUVBLE1BQU1DLFNBQVNWLHNEQUFTQTtRQUN4QixNQUFNVyxRQUFRRCxPQUFPRSxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVSLFFBQVEsS0FBS0E7UUFFOUMsSUFBSSxDQUFDTSxPQUFPO1lBQ1IsT0FBT1oscURBQVlBLENBQUNRLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUE2QixHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDcEY7UUFFQSw0Q0FBNEM7UUFDNUMsSUFBSUUsTUFBTUcsSUFBSSxJQUFJSCxNQUFNSSxJQUFJLEVBQUU7WUFDMUIsTUFBTUMsVUFBVSxNQUFNZiw2REFBY0EsQ0FBQ0ssVUFBVUssTUFBTUcsSUFBSSxFQUFFSCxNQUFNSSxJQUFJO1lBQ3JFLElBQUksQ0FBQ0MsU0FBUztnQkFDVixPQUFPakIscURBQVlBLENBQUNRLElBQUksQ0FBQztvQkFBRUMsT0FBTztnQkFBNkIsR0FBRztvQkFBRUMsUUFBUTtnQkFBSTtZQUNwRjtRQUNKLE9BQU8sSUFBSUUsTUFBTUwsUUFBUSxFQUFFO1lBQ3ZCLGdEQUFnRDtZQUNoRCxJQUFJSyxNQUFNTCxRQUFRLEtBQUtBLFVBQVU7Z0JBQzdCLE9BQU9QLHFEQUFZQSxDQUFDUSxJQUFJLENBQUM7b0JBQUVDLE9BQU87Z0JBQTZCLEdBQUc7b0JBQUVDLFFBQVE7Z0JBQUk7WUFDcEY7UUFDSixPQUFPO1lBQ0gsdUJBQXVCO1lBQ3ZCLE9BQU9WLHFEQUFZQSxDQUFDUSxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBNkIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3BGO1FBRUEsMkJBQTJCO1FBQzNCLE1BQU1RLFlBQVlDLEtBQUtDLEdBQUcsS0FBSyxLQUFLLEtBQUssS0FBSyxNQUFNLFFBQVE7UUFDNUQsTUFBTUMsVUFBVSxDQUFDLEVBQUVULE1BQU1OLFFBQVEsQ0FBQyxDQUFDLEVBQUVNLE1BQU1VLE1BQU0sQ0FBQyxDQUFDLEVBQUVKLFVBQVUsQ0FBQztRQUNoRSxNQUFNSyxRQUFRLE1BQU1wQiwwREFBV0EsQ0FBQ2tCO1FBRWhDLE1BQU0sRUFBRU4sSUFBSSxFQUFFQyxJQUFJLEVBQUVULFVBQVVpQixDQUFDLEVBQUUsR0FBR0MsV0FBVyxHQUFHYjtRQUVsRCxNQUFNYyxXQUFXMUIscURBQVlBLENBQUNRLElBQUksQ0FBQztZQUFFbUIsTUFBTUY7UUFBVTtRQUVyREMsU0FBU0UsT0FBTyxDQUFDQyxHQUFHLENBQUMsaUJBQWlCTixPQUFPO1lBQ3pDTyxVQUFVO1lBQ1ZDLFFBQVFDLGtCQUF5QjtZQUNqQ0MsVUFBVTtZQUNWQyxRQUFRLEtBQUssS0FBSztZQUNsQkMsTUFBTTtRQUNWO1FBRUEsT0FBT1Q7SUFDWCxFQUFFLE9BQU9qQixPQUFPO1FBQ1oyQixRQUFRM0IsS0FBSyxDQUFDLGdCQUFnQkE7UUFDOUIsT0FBT1QscURBQVlBLENBQUNRLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQWlCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3hFO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmVzZW50Ym94Ly4vYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzPzRmMjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBnZXRBZG1pbnMgfSBmcm9tICdAL2xpYi9hZG1pbnMnO1xyXG5pbXBvcnQgeyB2ZXJpZnlQYXNzd29yZCwgc2lnblNlc3Npb24gfSBmcm9tICdAL2xpYi9zZWN1cml0eSc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgdXNlcm5hbWUsIHBhc3N3b3JkIH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuXHJcbiAgICAgICAgaWYgKCF1c2VybmFtZSB8fCAhcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdMb2dpbiB2YSBwYXJvbCBraXJpdGlsaXNoaSBzaGFydCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGFkbWlucyA9IGdldEFkbWlucygpO1xyXG4gICAgICAgIGNvbnN0IGFkbWluID0gYWRtaW5zLmZpbmQoYSA9PiBhLnVzZXJuYW1lID09PSB1c2VybmFtZSk7XHJcblxyXG4gICAgICAgIGlmICghYWRtaW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTG9naW4geW9raSBwYXJvbCBub3RvJ2cncmlcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYWRtaW4gaGFzIGhhc2gvc2FsdCAobmV3IHN5c3RlbSlcclxuICAgICAgICBpZiAoYWRtaW4uaGFzaCAmJiBhZG1pbi5zYWx0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCB2ZXJpZnlQYXNzd29yZChwYXNzd29yZCwgYWRtaW4uaGFzaCwgYWRtaW4uc2FsdCk7XHJcbiAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTG9naW4geW9raSBwYXJvbCBub3RvJ2cncmlcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChhZG1pbi5wYXNzd29yZCkge1xyXG4gICAgICAgICAgICAvLyBGYWxsYmFjayBmb3Igb2xkIHN5c3RlbSAoaWYgYW55IGVudHJpZXMgbGVmdClcclxuICAgICAgICAgICAgaWYgKGFkbWluLnBhc3N3b3JkICE9PSBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTG9naW4geW9raSBwYXJvbCBub3RvJ2cncmlcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTm8gY3JlZGVudGlhbHMgZm91bmRcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTG9naW4geW9raSBwYXJvbCBub3RvJ2cncmlcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU3VjY2VzcyAtIENyZWF0ZSBTZXNzaW9uXHJcbiAgICAgICAgY29uc3QgZXhwaXJlc0F0ID0gRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDEgZGF5XHJcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IGAke2FkbWluLnVzZXJuYW1lfXwke2FkbWluLnJvbGVJZH18JHtleHBpcmVzQXR9YDtcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IHNpZ25TZXNzaW9uKHBheWxvYWQpO1xyXG5cclxuICAgICAgICBjb25zdCB7IGhhc2gsIHNhbHQsIHBhc3N3b3JkOiBfLCAuLi5hZG1pblNhZmUgfSA9IGFkbWluO1xyXG5cclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHsgdXNlcjogYWRtaW5TYWZlIH0pO1xyXG5cclxuICAgICAgICByZXNwb25zZS5jb29raWVzLnNldCgnYWRtaW5fc2Vzc2lvbicsIHRva2VuLCB7XHJcbiAgICAgICAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXHJcbiAgICAgICAgICAgIHNhbWVTaXRlOiAnc3RyaWN0JyxcclxuICAgICAgICAgICAgbWF4QWdlOiA2MCAqIDYwICogMjQsIC8vIDEgZGF5XHJcbiAgICAgICAgICAgIHBhdGg6ICcvJyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiTG9naW4gZXJyb3I6XCIsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1RpemltIHhhdG9saWdpJyB9LCB7IHN0YXR1czogNTAwIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRBZG1pbnMiLCJ2ZXJpZnlQYXNzd29yZCIsInNpZ25TZXNzaW9uIiwiUE9TVCIsInJlcXVlc3QiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiYWRtaW5zIiwiYWRtaW4iLCJmaW5kIiwiYSIsImhhc2giLCJzYWx0IiwiaXNWYWxpZCIsImV4cGlyZXNBdCIsIkRhdGUiLCJub3ciLCJwYXlsb2FkIiwicm9sZUlkIiwidG9rZW4iLCJfIiwiYWRtaW5TYWZlIiwicmVzcG9uc2UiLCJ1c2VyIiwiY29va2llcyIsInNldCIsImh0dHBPbmx5Iiwic2VjdXJlIiwicHJvY2VzcyIsInNhbWVTaXRlIiwibWF4QWdlIiwicGF0aCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/login/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/admins.ts":
/*!***********************!*\
  !*** ./lib/admins.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addAdmin: () => (/* binding */ addAdmin),\n/* harmony export */   deleteAdmin: () => (/* binding */ deleteAdmin),\n/* harmony export */   getAdmins: () => (/* binding */ getAdmins),\n/* harmony export */   saveAdmins: () => (/* binding */ saveAdmins),\n/* harmony export */   updateAdmin: () => (/* binding */ updateAdmin)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst DATA_DIR = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"data\");\nconst ADMINS_FILE = path__WEBPACK_IMPORTED_MODULE_1___default().join(DATA_DIR, \"admins.json\");\n// Ensure data directory exists\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(DATA_DIR)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(DATA_DIR, {\n        recursive: true\n    });\n}\nconst defaultAdmins = [\n    {\n        id: 1,\n        username: \"presentbox\",\n        roleId: 1,\n        password: \"admin123\",\n        fullName: \"Super Admin\",\n        createdAt: new Date().toISOString()\n    }\n];\nfunction getAdmins() {\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(ADMINS_FILE)) {\n        saveAdmins(defaultAdmins);\n        return defaultAdmins;\n    }\n    try {\n        const fileContent = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(ADMINS_FILE, \"utf-8\");\n        return JSON.parse(fileContent);\n    } catch (error) {\n        console.error(\"Error reading admins file:\", error);\n        return defaultAdmins;\n    }\n}\nfunction saveAdmins(admins) {\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(ADMINS_FILE, JSON.stringify(admins, null, 2), \"utf-8\");\n    } catch (error) {\n        console.error(\"Error writing admins file:\", error);\n    }\n}\nfunction addAdmin(adminData) {\n    const admins = getAdmins();\n    const newAdmin = {\n        ...adminData,\n        id: admins.length > 0 ? Math.max(...admins.map((a)=>a.id)) + 1 : 1,\n        createdAt: new Date().toISOString()\n    };\n    admins.push(newAdmin);\n    saveAdmins(admins);\n    return newAdmin;\n}\nfunction updateAdmin(id, updates) {\n    const admins = getAdmins();\n    const index = admins.findIndex((a)=>a.id === id);\n    if (index !== -1) {\n        admins[index] = {\n            ...admins[index],\n            ...updates\n        };\n        saveAdmins(admins);\n    }\n    return admins;\n}\nfunction deleteAdmin(id) {\n    let admins = getAdmins();\n    // Prevent deleting the last super admin\n    const adminToDelete = admins.find((a)=>a.id === id);\n    if (adminToDelete?.roleId === 1) {\n        const superAdminsCount = admins.filter((a)=>a.roleId === 1).length;\n        if (superAdminsCount <= 1) {\n            throw new Error(\"Cannot delete the last Super Admin\");\n        }\n    }\n    admins = admins.filter((a)=>a.id !== id);\n    saveAdmins(admins);\n    return admins;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWRtaW5zLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUNvQjtBQUNJO0FBRXhCLE1BQU1FLFdBQVdELGdEQUFTLENBQUNHLFFBQVFDLEdBQUcsSUFBSTtBQUMxQyxNQUFNQyxjQUFjTCxnREFBUyxDQUFDQyxVQUFVO0FBRXhDLCtCQUErQjtBQUMvQixJQUFJLENBQUNGLG9EQUFhLENBQUNFLFdBQVc7SUFDMUJGLG1EQUFZLENBQUNFLFVBQVU7UUFBRU8sV0FBVztJQUFLO0FBQzdDO0FBYUEsTUFBTUMsZ0JBQXlCO0lBQzNCO1FBQ0lDLElBQUk7UUFDSkMsVUFBVTtRQUNWQyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsVUFBVTtRQUNWQyxXQUFXLElBQUlDLE9BQU9DLFdBQVc7SUFDckM7Q0FDSDtBQUVNLFNBQVNDO0lBQ1osSUFBSSxDQUFDbkIsb0RBQWEsQ0FBQ00sY0FBYztRQUM3QmMsV0FBV1Y7UUFDWCxPQUFPQTtJQUNYO0lBRUEsSUFBSTtRQUNBLE1BQU1XLGNBQWNyQixzREFBZSxDQUFDTSxhQUFhO1FBQ2pELE9BQU9pQixLQUFLQyxLQUFLLENBQUNIO0lBQ3RCLEVBQUUsT0FBT0ksT0FBTztRQUNaQyxRQUFRRCxLQUFLLENBQUMsOEJBQThCQTtRQUM1QyxPQUFPZjtJQUNYO0FBQ0o7QUFFTyxTQUFTVSxXQUFXTyxNQUFlO0lBQ3RDLElBQUk7UUFDQTNCLHVEQUFnQixDQUFDTSxhQUFhaUIsS0FBS00sU0FBUyxDQUFDRixRQUFRLE1BQU0sSUFBSTtJQUNuRSxFQUFFLE9BQU9GLE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLDhCQUE4QkE7SUFDaEQ7QUFDSjtBQUVPLFNBQVNLLFNBQVNDLFNBQTBDO0lBQy9ELE1BQU1KLFNBQVNSO0lBQ2YsTUFBTWEsV0FBa0I7UUFDcEIsR0FBR0QsU0FBUztRQUNacEIsSUFBSWdCLE9BQU9NLE1BQU0sR0FBRyxJQUFJQyxLQUFLQyxHQUFHLElBQUlSLE9BQU9TLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRTFCLEVBQUUsS0FBSyxJQUFJO1FBQ2pFSyxXQUFXLElBQUlDLE9BQU9DLFdBQVc7SUFDckM7SUFFQVMsT0FBT1csSUFBSSxDQUFDTjtJQUNaWixXQUFXTztJQUNYLE9BQU9LO0FBQ1g7QUFFTyxTQUFTTyxZQUFZNUIsRUFBVSxFQUFFNkIsT0FBdUI7SUFDM0QsTUFBTWIsU0FBU1I7SUFDZixNQUFNc0IsUUFBUWQsT0FBT2UsU0FBUyxDQUFDTCxDQUFBQSxJQUFLQSxFQUFFMUIsRUFBRSxLQUFLQTtJQUU3QyxJQUFJOEIsVUFBVSxDQUFDLEdBQUc7UUFDZGQsTUFBTSxDQUFDYyxNQUFNLEdBQUc7WUFBRSxHQUFHZCxNQUFNLENBQUNjLE1BQU07WUFBRSxHQUFHRCxPQUFPO1FBQUM7UUFDL0NwQixXQUFXTztJQUNmO0lBRUEsT0FBT0E7QUFDWDtBQUVPLFNBQVNnQixZQUFZaEMsRUFBVTtJQUNsQyxJQUFJZ0IsU0FBU1I7SUFDYix3Q0FBd0M7SUFDeEMsTUFBTXlCLGdCQUFnQmpCLE9BQU9rQixJQUFJLENBQUNSLENBQUFBLElBQUtBLEVBQUUxQixFQUFFLEtBQUtBO0lBQ2hELElBQUlpQyxlQUFlL0IsV0FBVyxHQUFHO1FBQzdCLE1BQU1pQyxtQkFBbUJuQixPQUFPb0IsTUFBTSxDQUFDVixDQUFBQSxJQUFLQSxFQUFFeEIsTUFBTSxLQUFLLEdBQUdvQixNQUFNO1FBQ2xFLElBQUlhLG9CQUFvQixHQUFHO1lBQ3ZCLE1BQU0sSUFBSUUsTUFBTTtRQUNwQjtJQUNKO0lBRUFyQixTQUFTQSxPQUFPb0IsTUFBTSxDQUFDVixDQUFBQSxJQUFLQSxFQUFFMUIsRUFBRSxLQUFLQTtJQUNyQ1MsV0FBV087SUFDWCxPQUFPQTtBQUNYIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJlc2VudGJveC8uL2xpYi9hZG1pbnMudHM/MDVjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcblxyXG5jb25zdCBEQVRBX0RJUiA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZGF0YScpO1xyXG5jb25zdCBBRE1JTlNfRklMRSA9IHBhdGguam9pbihEQVRBX0RJUiwgJ2FkbWlucy5qc29uJyk7XHJcblxyXG4vLyBFbnN1cmUgZGF0YSBkaXJlY3RvcnkgZXhpc3RzXHJcbmlmICghZnMuZXhpc3RzU3luYyhEQVRBX0RJUikpIHtcclxuICAgIGZzLm1rZGlyU3luYyhEQVRBX0RJUiwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQWRtaW4ge1xyXG4gICAgaWQ6IG51bWJlcjtcclxuICAgIHVzZXJuYW1lOiBzdHJpbmc7XHJcbiAgICByb2xlSWQ6IG51bWJlcjtcclxuICAgIHBhc3N3b3JkPzogc3RyaW5nOyAvLyBAZGVwcmVjYXRlZCAtIHVzZSBoYXNoL3NhbHRcclxuICAgIGhhc2g/OiBzdHJpbmc7XHJcbiAgICBzYWx0Pzogc3RyaW5nO1xyXG4gICAgZnVsbE5hbWU6IHN0cmluZztcclxuICAgIGNyZWF0ZWRBdDogc3RyaW5nO1xyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0QWRtaW5zOiBBZG1pbltdID0gW1xyXG4gICAge1xyXG4gICAgICAgIGlkOiAxLFxyXG4gICAgICAgIHVzZXJuYW1lOiBcInByZXNlbnRib3hcIixcclxuICAgICAgICByb2xlSWQ6IDEsXHJcbiAgICAgICAgcGFzc3dvcmQ6IFwiYWRtaW4xMjNcIixcclxuICAgICAgICBmdWxsTmFtZTogXCJTdXBlciBBZG1pblwiLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9XHJcbl07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWRtaW5zKCk6IEFkbWluW10ge1xyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKEFETUlOU19GSUxFKSkge1xyXG4gICAgICAgIHNhdmVBZG1pbnMoZGVmYXVsdEFkbWlucyk7XHJcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRBZG1pbnM7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhBRE1JTlNfRklMRSwgJ3V0Zi04Jyk7XHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZmlsZUNvbnRlbnQpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVhZGluZyBhZG1pbnMgZmlsZTpcIiwgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBkZWZhdWx0QWRtaW5zO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2F2ZUFkbWlucyhhZG1pbnM6IEFkbWluW10pOiB2b2lkIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgZnMud3JpdGVGaWxlU3luYyhBRE1JTlNfRklMRSwgSlNPTi5zdHJpbmdpZnkoYWRtaW5zLCBudWxsLCAyKSwgJ3V0Zi04Jyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3cml0aW5nIGFkbWlucyBmaWxlOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRBZG1pbihhZG1pbkRhdGE6IE9taXQ8QWRtaW4sICdpZCcgfCAnY3JlYXRlZEF0Jz4pOiBBZG1pbiB7XHJcbiAgICBjb25zdCBhZG1pbnMgPSBnZXRBZG1pbnMoKTtcclxuICAgIGNvbnN0IG5ld0FkbWluOiBBZG1pbiA9IHtcclxuICAgICAgICAuLi5hZG1pbkRhdGEsXHJcbiAgICAgICAgaWQ6IGFkbWlucy5sZW5ndGggPiAwID8gTWF0aC5tYXgoLi4uYWRtaW5zLm1hcChhID0+IGEuaWQpKSArIDEgOiAxLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuXHJcbiAgICBhZG1pbnMucHVzaChuZXdBZG1pbik7XHJcbiAgICBzYXZlQWRtaW5zKGFkbWlucyk7XHJcbiAgICByZXR1cm4gbmV3QWRtaW47XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVBZG1pbihpZDogbnVtYmVyLCB1cGRhdGVzOiBQYXJ0aWFsPEFkbWluPik6IEFkbWluW10ge1xyXG4gICAgY29uc3QgYWRtaW5zID0gZ2V0QWRtaW5zKCk7XHJcbiAgICBjb25zdCBpbmRleCA9IGFkbWlucy5maW5kSW5kZXgoYSA9PiBhLmlkID09PSBpZCk7XHJcblxyXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgIGFkbWluc1tpbmRleF0gPSB7IC4uLmFkbWluc1tpbmRleF0sIC4uLnVwZGF0ZXMgfTtcclxuICAgICAgICBzYXZlQWRtaW5zKGFkbWlucyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGFkbWlucztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUFkbWluKGlkOiBudW1iZXIpOiBBZG1pbltdIHtcclxuICAgIGxldCBhZG1pbnMgPSBnZXRBZG1pbnMoKTtcclxuICAgIC8vIFByZXZlbnQgZGVsZXRpbmcgdGhlIGxhc3Qgc3VwZXIgYWRtaW5cclxuICAgIGNvbnN0IGFkbWluVG9EZWxldGUgPSBhZG1pbnMuZmluZChhID0+IGEuaWQgPT09IGlkKTtcclxuICAgIGlmIChhZG1pblRvRGVsZXRlPy5yb2xlSWQgPT09IDEpIHtcclxuICAgICAgICBjb25zdCBzdXBlckFkbWluc0NvdW50ID0gYWRtaW5zLmZpbHRlcihhID0+IGEucm9sZUlkID09PSAxKS5sZW5ndGg7XHJcbiAgICAgICAgaWYgKHN1cGVyQWRtaW5zQ291bnQgPD0gMSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZGVsZXRlIHRoZSBsYXN0IFN1cGVyIEFkbWluXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhZG1pbnMgPSBhZG1pbnMuZmlsdGVyKGEgPT4gYS5pZCAhPT0gaWQpO1xyXG4gICAgc2F2ZUFkbWlucyhhZG1pbnMpO1xyXG4gICAgcmV0dXJuIGFkbWlucztcclxufVxyXG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiREFUQV9ESVIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsIkFETUlOU19GSUxFIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsImRlZmF1bHRBZG1pbnMiLCJpZCIsInVzZXJuYW1lIiwicm9sZUlkIiwicGFzc3dvcmQiLCJmdWxsTmFtZSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImdldEFkbWlucyIsInNhdmVBZG1pbnMiLCJmaWxlQ29udGVudCIsInJlYWRGaWxlU3luYyIsIkpTT04iLCJwYXJzZSIsImVycm9yIiwiY29uc29sZSIsImFkbWlucyIsIndyaXRlRmlsZVN5bmMiLCJzdHJpbmdpZnkiLCJhZGRBZG1pbiIsImFkbWluRGF0YSIsIm5ld0FkbWluIiwibGVuZ3RoIiwiTWF0aCIsIm1heCIsIm1hcCIsImEiLCJwdXNoIiwidXBkYXRlQWRtaW4iLCJ1cGRhdGVzIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJkZWxldGVBZG1pbiIsImFkbWluVG9EZWxldGUiLCJmaW5kIiwic3VwZXJBZG1pbnNDb3VudCIsImZpbHRlciIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/admins.ts\n");

/***/ }),

/***/ "(rsc)/./lib/security.ts":
/*!*************************!*\
  !*** ./lib/security.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   signSession: () => (/* binding */ signSession),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword),\n/* harmony export */   verifySession: () => (/* binding */ verifySession)\n/* harmony export */ });\nconst SECRET_KEY = process.env.SESSION_SECRET || \"super-secret-key-change-this-in-prod\";\nfunction getEncoder() {\n    return new TextEncoder();\n}\nfunction bufferToHex(buffer) {\n    const uint8Arr = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer instanceof ArrayBuffer ? buffer : buffer.buffer);\n    return Array.from(uint8Arr).map((b)=>b.toString(16).padStart(2, \"0\")).join(\"\");\n}\nfunction hexToUint8Array(hexString) {\n    const matches = hexString.match(/.{1,2}/g);\n    if (!matches) return new Uint8Array(0);\n    return new Uint8Array(matches.map((byte)=>parseInt(byte, 16)));\n}\nasync function hashPassword(password) {\n    const salt = crypto.getRandomValues(new Uint8Array(16));\n    const keyMaterial = await crypto.subtle.importKey(\"raw\", getEncoder().encode(password), {\n        name: \"PBKDF2\"\n    }, false, [\n        \"deriveBits\"\n    ]);\n    const hashBuffer = await crypto.subtle.deriveBits({\n        name: \"PBKDF2\",\n        salt: salt,\n        iterations: 1000,\n        hash: \"SHA-512\"\n    }, keyMaterial, 64 * 8 // 512 bits\n    );\n    return {\n        hash: bufferToHex(hashBuffer),\n        salt: bufferToHex(salt)\n    };\n}\nasync function verifyPassword(password, hash, salt) {\n    const saltBuffer = hexToUint8Array(salt);\n    const keyMaterial = await crypto.subtle.importKey(\"raw\", getEncoder().encode(password), {\n        name: \"PBKDF2\"\n    }, false, [\n        \"deriveBits\"\n    ]);\n    const verifyHashBuffer = await crypto.subtle.deriveBits({\n        name: \"PBKDF2\",\n        salt: saltBuffer,\n        iterations: 1000,\n        hash: \"SHA-512\"\n    }, keyMaterial, 64 * 8);\n    const verifyHash = bufferToHex(verifyHashBuffer);\n    return verifyHash === hash;\n}\nasync function signSession(payload) {\n    const key = await crypto.subtle.importKey(\"raw\", getEncoder().encode(SECRET_KEY), {\n        name: \"HMAC\",\n        hash: \"SHA-256\"\n    }, false, [\n        \"sign\"\n    ]);\n    const signatureBuffer = await crypto.subtle.sign(\"HMAC\", key, getEncoder().encode(payload));\n    const signature = bufferToHex(signatureBuffer);\n    return `${payload}.${signature}`;\n}\nasync function verifySession(token) {\n    const [payload, signature] = token.split(\".\");\n    if (!payload || !signature) return null;\n    try {\n        const key = await crypto.subtle.importKey(\"raw\", getEncoder().encode(SECRET_KEY), {\n            name: \"HMAC\",\n            hash: \"SHA-256\"\n        }, false, [\n            \"verify\"\n        ]);\n        const signatureBytes = hexToUint8Array(signature);\n        const dataBytes = getEncoder().encode(payload);\n        const isValid = await crypto.subtle.verify(\"HMAC\", key, signatureBytes, dataBytes);\n        if (isValid) {\n            return payload;\n        }\n    } catch (e) {\n        console.error(\"Session verification failed\", e);\n        return null;\n    }\n    return null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNO1lBQVFJLE1BQU07UUFBVSxHQUNoQyxPQUNBO1lBQUM7U0FBUztRQUdkLE1BQU1jLGlCQUFpQmpDLGdCQUFnQjZCO1FBQ3ZDLE1BQU1LLFlBQVloRCxhQUFhNEIsTUFBTSxDQUFDVztRQUV0QyxNQUFNVSxVQUFVLE1BQU0xQixPQUFPRyxNQUFNLENBQUN3QixNQUFNLENBQ3RDLFFBQ0FWLEtBQ0FPLGdCQUNBQztRQUdKLElBQUlDLFNBQVM7WUFDVCxPQUFPVjtRQUNYO0lBQ0osRUFBRSxPQUFPWSxHQUFHO1FBQ1JDLFFBQVFDLEtBQUssQ0FBQywrQkFBK0JGO1FBQzdDLE9BQU87SUFDWDtJQUNBLE9BQU87QUFDWCIsInNvdXJjZXMiOlsid2VicGFjazovL3ByZXNlbnRib3gvLi9saWIvc2VjdXJpdHkudHM/MTkwYSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTRUNSRVRfS0VZID0gcHJvY2Vzcy5lbnYuU0VTU0lPTl9TRUNSRVQgfHwgJ3N1cGVyLXNlY3JldC1rZXktY2hhbmdlLXRoaXMtaW4tcHJvZCc7XHJcblxyXG5mdW5jdGlvbiBnZXRFbmNvZGVyKCkge1xyXG4gICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWZmZXJUb0hleChidWZmZXI6IEFycmF5QnVmZmVyIHwgQXJyYXlCdWZmZXJWaWV3KTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHVpbnQ4QXJyID0gYnVmZmVyIGluc3RhbmNlb2YgVWludDhBcnJheVxyXG4gICAgICAgID8gYnVmZmVyXHJcbiAgICAgICAgOiBuZXcgVWludDhBcnJheShidWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciA/IGJ1ZmZlciA6IChidWZmZXIgYXMgYW55KS5idWZmZXIpO1xyXG5cclxuICAgIHJldHVybiBBcnJheS5mcm9tKHVpbnQ4QXJyKVxyXG4gICAgICAgIC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxyXG4gICAgICAgIC5qb2luKCcnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGV4VG9VaW50OEFycmF5KGhleFN0cmluZzogc3RyaW5nKTogVWludDhBcnJheSB7XHJcbiAgICBjb25zdCBtYXRjaGVzID0gaGV4U3RyaW5nLm1hdGNoKC8uezEsMn0vZyk7XHJcbiAgICBpZiAoIW1hdGNoZXMpIHJldHVybiBuZXcgVWludDhBcnJheSgwKTtcclxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShtYXRjaGVzLm1hcChieXRlID0+IHBhcnNlSW50KGJ5dGUsIDE2KSkpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzaFBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHsgaGFzaDogc3RyaW5nOyBzYWx0OiBzdHJpbmcgfT4ge1xyXG4gICAgY29uc3Qgc2FsdCA9IGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTYpKTtcclxuICAgIGNvbnN0IGtleU1hdGVyaWFsID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXHJcbiAgICAgICAgXCJyYXdcIixcclxuICAgICAgICBnZXRFbmNvZGVyKCkuZW5jb2RlKHBhc3N3b3JkKSxcclxuICAgICAgICB7IG5hbWU6IFwiUEJLREYyXCIgfSxcclxuICAgICAgICBmYWxzZSxcclxuICAgICAgICBbXCJkZXJpdmVCaXRzXCJdXHJcbiAgICApO1xyXG4gICAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGVyaXZlQml0cyhcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG5hbWU6IFwiUEJLREYyXCIsXHJcbiAgICAgICAgICAgIHNhbHQ6IHNhbHQsXHJcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IDEwMDAsXHJcbiAgICAgICAgICAgIGhhc2g6IFwiU0hBLTUxMlwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBrZXlNYXRlcmlhbCxcclxuICAgICAgICA2NCAqIDggLy8gNTEyIGJpdHNcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBoYXNoOiBidWZmZXJUb0hleChoYXNoQnVmZmVyKSxcclxuICAgICAgICBzYWx0OiBidWZmZXJUb0hleChzYWx0KVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcsIGhhc2g6IHN0cmluZywgc2FsdDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICBjb25zdCBzYWx0QnVmZmVyID0gaGV4VG9VaW50OEFycmF5KHNhbHQpO1xyXG4gICAgY29uc3Qga2V5TWF0ZXJpYWwgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcclxuICAgICAgICBcInJhd1wiLFxyXG4gICAgICAgIGdldEVuY29kZXIoKS5lbmNvZGUocGFzc3dvcmQpLFxyXG4gICAgICAgIHsgbmFtZTogXCJQQktERjJcIiB9LFxyXG4gICAgICAgIGZhbHNlLFxyXG4gICAgICAgIFtcImRlcml2ZUJpdHNcIl1cclxuICAgICk7XHJcbiAgICBjb25zdCB2ZXJpZnlIYXNoQnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kZXJpdmVCaXRzKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbmFtZTogXCJQQktERjJcIixcclxuICAgICAgICAgICAgc2FsdDogc2FsdEJ1ZmZlciBhcyBCdWZmZXJTb3VyY2UsXHJcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IDEwMDAsXHJcbiAgICAgICAgICAgIGhhc2g6IFwiU0hBLTUxMlwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBrZXlNYXRlcmlhbCxcclxuICAgICAgICA2NCAqIDhcclxuICAgICk7XHJcbiAgICBjb25zdCB2ZXJpZnlIYXNoID0gYnVmZmVyVG9IZXgodmVyaWZ5SGFzaEJ1ZmZlcik7XHJcblxyXG4gICAgcmV0dXJuIHZlcmlmeUhhc2ggPT09IGhhc2g7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduU2Vzc2lvbihwYXlsb2FkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgY29uc3Qga2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXHJcbiAgICAgICAgXCJyYXdcIixcclxuICAgICAgICBnZXRFbmNvZGVyKCkuZW5jb2RlKFNFQ1JFVF9LRVkpLFxyXG4gICAgICAgIHsgbmFtZTogXCJITUFDXCIsIGhhc2g6IFwiU0hBLTI1NlwiIH0sXHJcbiAgICAgICAgZmFsc2UsXHJcbiAgICAgICAgW1wic2lnblwiXVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHNpZ25hdHVyZUJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuc2lnbihcclxuICAgICAgICBcIkhNQUNcIixcclxuICAgICAgICBrZXksXHJcbiAgICAgICAgZ2V0RW5jb2RlcigpLmVuY29kZShwYXlsb2FkKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGJ1ZmZlclRvSGV4KHNpZ25hdHVyZUJ1ZmZlcik7XHJcbiAgICByZXR1cm4gYCR7cGF5bG9hZH0uJHtzaWduYXR1cmV9YDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVNlc3Npb24odG9rZW46IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xyXG4gICAgY29uc3QgW3BheWxvYWQsIHNpZ25hdHVyZV0gPSB0b2tlbi5zcGxpdCgnLicpO1xyXG4gICAgaWYgKCFwYXlsb2FkIHx8ICFzaWduYXR1cmUpIHJldHVybiBudWxsO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXHJcbiAgICAgICAgICAgIFwicmF3XCIsXHJcbiAgICAgICAgICAgIGdldEVuY29kZXIoKS5lbmNvZGUoU0VDUkVUX0tFWSksXHJcbiAgICAgICAgICAgIHsgbmFtZTogXCJITUFDXCIsIGhhc2g6IFwiU0hBLTI1NlwiIH0sXHJcbiAgICAgICAgICAgIGZhbHNlLFxyXG4gICAgICAgICAgICBbXCJ2ZXJpZnlcIl1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IGhleFRvVWludDhBcnJheShzaWduYXR1cmUpO1xyXG4gICAgICAgIGNvbnN0IGRhdGFCeXRlcyA9IGdldEVuY29kZXIoKS5lbmNvZGUocGF5bG9hZCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBjcnlwdG8uc3VidGxlLnZlcmlmeShcclxuICAgICAgICAgICAgXCJITUFDXCIsXHJcbiAgICAgICAgICAgIGtleSxcclxuICAgICAgICAgICAgc2lnbmF0dXJlQnl0ZXMgYXMgQnVmZmVyU291cmNlLFxyXG4gICAgICAgICAgICBkYXRhQnl0ZXNcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGF5bG9hZDtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlNlc3Npb24gdmVyaWZpY2F0aW9uIGZhaWxlZFwiLCBlKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJTRUNSRVRfS0VZIiwicHJvY2VzcyIsImVudiIsIlNFU1NJT05fU0VDUkVUIiwiZ2V0RW5jb2RlciIsIlRleHRFbmNvZGVyIiwiYnVmZmVyVG9IZXgiLCJidWZmZXIiLCJ1aW50OEFyciIsIlVpbnQ4QXJyYXkiLCJBcnJheUJ1ZmZlciIsIkFycmF5IiwiZnJvbSIsIm1hcCIsImIiLCJ0b1N0cmluZyIsInBhZFN0YXJ0Iiwiam9pbiIsImhleFRvVWludDhBcnJheSIsImhleFN0cmluZyIsIm1hdGNoZXMiLCJtYXRjaCIsImJ5dGUiLCJwYXJzZUludCIsImhhc2hQYXNzd29yZCIsInBhc3N3b3JkIiwic2FsdCIsImNyeXB0byIsImdldFJhbmRvbVZhbHVlcyIsImtleU1hdGVyaWFsIiwic3VidGxlIiwiaW1wb3J0S2V5IiwiZW5jb2RlIiwibmFtZSIsImhhc2hCdWZmZXIiLCJkZXJpdmVCaXRzIiwiaXRlcmF0aW9ucyIsImhhc2giLCJ2ZXJpZnlQYXNzd29yZCIsInNhbHRCdWZmZXIiLCJ2ZXJpZnlIYXNoQnVmZmVyIiwidmVyaWZ5SGFzaCIsInNpZ25TZXNzaW9uIiwicGF5bG9hZCIsImtleSIsInNpZ25hdHVyZUJ1ZmZlciIsInNpZ24iLCJzaWduYXR1cmUiLCJ2ZXJpZnlTZXNzaW9uIiwidG9rZW4iLCJzcGxpdCIsInNpZ25hdHVyZUJ5dGVzIiwiZGF0YUJ5dGVzIiwiaXNWYWxpZCIsInZlcmlmeSIsImUiLCJjb25zb2xlIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/security.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWindows%2011%5C.gemini%5Cantigravity%5Cscratch%5Cpresentbox&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();